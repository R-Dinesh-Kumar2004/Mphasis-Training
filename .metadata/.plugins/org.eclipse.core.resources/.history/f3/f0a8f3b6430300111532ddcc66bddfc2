package com.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.Statement;

import com.dbutil.DBUtil;
import com.model.Employee;

public class EmployeeDaoImpl implements EmployeeDao{

	@Override
	public int createSchema() throws SQLException {
		int result = 0;
		
		try(Connection connection = DBUtil.getConnection();
				Statement stmt = connection.createStatement();
				){
			result = stmt.executeUpdate(DBUtil.SCHEMA);
		}
		
		return result;
	}

	@Override
	public int createTable() throws SQLException {
		int result = 1;
		
		try(Connection connection = DBUtil.getConnection();
				Statement stmt = connection.createStatement();
				){
			result = stmt.executeUpdate(DBUtil.CREATE_TABLE);
		}
		
		return result;
	}

	@Override
	public int insertEmployee(Employee employee) throws SQLException {
		int result = 0;
		
		try(Connection connection = DBUtil.getSchemaConnection();
				PreparedStatement pst = connection.prepareStatement(DBUtil.INSERT_QUERY);
				){
			pst.setString(0, employee.getName());
		}
		
		return result;
	}
	
}
